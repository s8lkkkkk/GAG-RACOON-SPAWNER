-- Services
local Players = game:GetService('Players')
local LocalPlayer = Players.LocalPlayer

-- GUI setup
local g = Instance.new('ScreenGui', LocalPlayer:WaitForChild('PlayerGui'))
g.Name = 'PetGenUI'

local f = Instance.new('Frame', g)
f.Size = UDim2.new(0, 300, 0, 320)
f.Position = UDim2.new(0.5, -150, 0.5, -160)
f.BackgroundColor3 = Color3.fromRGB(30,30,30)
f.Active = true
f.Draggable = true

-- ======= PET SYSTEM =======
local pets = {
    {'Raccoon', Color3.fromRGB(0,135,255), '112383235077808', '100522907734059'},
    {'Butterfly', Color3.fromRGB(255,100,200), 'PUT_BUTTERFLY_MESHID_HERE', 'PUT_BUTTERFLY_TEXTUREID_HERE'},
    {'Dragonfly', Color3.fromRGB(100,255,150), 'PUT_DRAGONFLY_MESHID_HERE', 'PUT_DRAGONFLY_TEXTUREID_HERE'}
}

local toggles = {}

local function setupPetBehavior(model, root, height)
    model.PrimaryPart = root
    local part = model:FindFirstChildOfClass("Part")
    local mesh = part:FindFirstChildOfClass("SpecialMesh")
    local centerPos = root.Position
    local areaRadius = 17
    local speed = 4
    local rotationSpeed = 2

    task.spawn(function()
        while true do
            local targetPos = Vector3.new(
                centerPos.X + math.random(-areaRadius*10, areaRadius*10)/10,
                height,
                centerPos.Z + math.random(-areaRadius*10, areaRadius*10)/10
            )

            local direction = (targetPos - part.Position)
            local distance = direction.Magnitude
            direction = direction.Unit

            local currentCFrame = part.CFrame
            local targetCFrame = CFrame.new(part.Position, Vector3.new(targetPos.X, part.Position.Y, targetPos.Z))
            local rotationTime = 0
            while rotationTime < 1 do
                part.CFrame = currentCFrame:Lerp(targetCFrame, rotationTime)
                rotationTime = rotationTime + rotationSpeed * 0.03
                task.wait(0.03)
            end
            part.CFrame = targetCFrame

            local steps = math.ceil(distance / 0.2)
            local stepAngle = 0
            for i = 1, steps do
                part.Position = part.Position + direction * 0.2
                if mesh then
                    stepAngle = stepAngle + math.rad(15)
                    mesh.Offset = Vector3.new(0, math.sin(stepAngle) * 0.1, 0)
                end
                task.wait(0.03)
            end
            task.wait(0.5)
        end
    end)
end

-- Pet Buttons
for i, v in ipairs(pets) do
    local name, color, meshId, textureId = v[1], v[2], v[3], v[4]
    local b = Instance.new('TextButton', f)
    b.Size = UDim2.new(0.9,0,0,40)
    b.Position = UDim2.new(0.05,0,0,(i-1)*50+10)
    b.BackgroundColor3 = color
    b.Text = 'Start '..name
    b.TextColor3 = Color3.new(1,1,1)
    b.Font = Enum.Font.GothamBold
    b.TextSize = 16

    toggles[name] = false

    b.MouseButton1Click:Connect(function()
        toggles[name] = not toggles[name]
        b.Text = (toggles[name] and 'Stop' or 'Start')..' '..name

        if toggles[name] then
            task.spawn(function()
                while toggles[name] do
                    local weight = math.random(1100,1600) / 100
                    local age = math.random(1,25)
                    local t = Instance.new('Tool')
                    t.Name = name.."\n["..string.format("%.2f", weight).." KG]\n[Age "..age.."]"

                    local h = Instance.new('Part')
                    h.Name = 'Handle'
                    h.Size = Vector3.new(2,2,2)
                    h.Parent = t

                    local mesh = Instance.new('SpecialMesh', h)
                    mesh.MeshType = Enum.MeshType.FileMesh
                    mesh.MeshId = 'rbxassetid://'..meshId
                    mesh.TextureId = 'rbxassetid://'..textureId

                    local baseSize = 2
                    local meshSize = baseSize + 0.25 * (weight - 10)
                    mesh.Scale = Vector3.new(meshSize, meshSize, meshSize)

                    t.Parent = LocalPlayer.Backpack
                    task.wait(0.2)

                    t.Activated:Connect(function()
                        local mouse = LocalPlayer:GetMouse()
                        local height = 4 + 0.1 * (weight - 10)
                        if weight == 11 then height = height - 0.5
                        elseif weight == 12 then height = height - 0.3 end

                        local position = Vector3.new(mouse.Hit.Position.X, height, mouse.Hit.Position.Z)

                        local model = Instance.new('Model')
                        model.Name = t.Name

                        local partClone = h:Clone()
                        partClone.Anchored = false
                        partClone.CanCollide = false
                        partClone.Position = position
                        partClone.Parent = model

                        local root = Instance.new('Part')
                        root.Name = 'HumanoidRootPart'
                        root.Size = Vector3.new(0.5,0.5,0.5)
                        root.Transparency = 1
                        root.Anchored = true
                        root.CanCollide = false
                        root.Position = position - Vector3.new(0,0,1)
                        root.Parent = model
                        model.PrimaryPart = root

                        local weld = Instance.new('WeldConstraint')
                        weld.Part0 = root
                        weld.Part1 = partClone
                        weld.Parent = root

                        model.Parent = workspace
                        t:Destroy()

                        setupPetBehavior(model, root, height)
                    end)
                end
            end)
        end
    end)
end

-- ======= AUTO JUMP SYSTEM =======
-- Status label
local statusLabel = Instance.new("TextLabel", f)
statusLabel.Size = UDim2.new(0.9,0,0,30)
statusLabel.Position = UDim2.new(0.05,0,0,250)
statusLabel.BackgroundTransparency = 1
statusLabel.TextColor3 = Color3.new(1,1,1)
statusLabel.Text = "Auto Jump: Stopped"
statusLabel.Font = Enum.Font.SourceSansBold
statusLabel.TextScaled = true

-- Interval box
local intervalBox = Instance.new("TextBox", f)
intervalBox.Size = UDim2.new(0.4,0,0,30)
intervalBox.Position = UDim2.new(0.05,0,0,280)
intervalBox.BackgroundColor3 = Color3.fromRGB(60,60,60)
intervalBox.TextColor3 = Color3.new(1,1,1)
intervalBox.Text = "60"
intervalBox.ClearTextOnFocus = false
intervalBox.Font = Enum.Font.SourceSans
intervalBox.TextScaled = true

-- Start button
local startBtn = Instance.new("TextButton", f)
startBtn.Size = UDim2.new(0.2,0,0,30)
startBtn.Position = UDim2.new(0.5,0,0,280)
startBtn.BackgroundColor3 = Color3.fromRGB(0,170,0)
startBtn.TextColor3 = Color3.new(1,1,1)
startBtn.Text = "Start"
startBtn.Font = Enum.Font.SourceSansBold
startBtn.TextScaled = true

-- Stop button
local stopBtn = Instance.new("TextButton", f)
stopBtn.Size = UDim2.new(0.2,0,0,30)
stopBtn.Position = UDim2.new(0.75,0,0,280)
stopBtn.BackgroundColor3 = Color3.fromRGB(170,0,0)
stopBtn.TextColor3 = Color3.new(1,1,1)
stopBtn.Text = "Stop"
stopBtn.Font = Enum.Font.SourceSansBold
stopBtn.TextScaled = true

-- Jump loop
local running = false
local function startJumpLoop()
    running = true
    while running do
        local interval = tonumber(intervalBox.Text) or 60
        if interval < 1 then interval = 1 end

        for t = interval, 1, -1 do
            if not running then break end
            statusLabel.Text = "Jumping in: "..t.."s"
            task.wait(1)
        end

        if running then
            local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
            local humanoid = char:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                statusLabel.Text = "Jumped!"
                task.wait(0.5)
            else
                statusLabel.Text = "No Humanoid found!"
            end
        end
    end
end

local function stopJumpLoop()
    running = false
    statusLabel.Text = "Auto Jump: Stopped"
end

startBtn.MouseButton1Click:Connect(function()
    if not running then task.spawn(startJumpLoop) end
end)

stopBtn.MouseButton1Click:Connect(stopJumpLoop)
